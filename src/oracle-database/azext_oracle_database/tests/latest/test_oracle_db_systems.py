# --------------------------------------------------------------------------------------------
# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License. See License.txt in the project root for license information.
#
# Code generated by aaz-dev-tools
# --------------------------------------------------------------------------------------------
import os
import unittest
import time

from azure.cli.testsdk.scenario_tests import AllowLargeResponse
from azure.cli.testsdk import (ScenarioTest, ResourceGroupPreparer, live_only)

class OracleDbSystemScenarioTest(ScenarioTest):
    @live_only()
    @AllowLargeResponse(size_kb=10240)
    @ResourceGroupPreparer(name_prefix='cli_test_odba_rg')
    def setUp(self):
        subscription_id = self.get_subscription_id()
        self.kwargs.update({
            'db_system_name': 'AzureCliSdkNewMih',
            'resource_group': 'azCliTest',
            'location': 'eastus',
            'zone': '1',
            'database_edition': 'EnterpriseEdition',
            'admin_password': 'TesT##1234',
            'resource_anchor_id': '/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/azCliTest/providers/Oracle.Database/resourceAnchors/AzureCliTestMi',
            'network_anchor_id': '/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/yumfeiTest/providers/Oracle.Database/networkAnchors/1202yumfeiDnsNa1',
            'hostname': 'basedbNew',
            'shape': 'VM.Standard.E5.Flex',
            'display_name': 'BaseDbWhitelisMih',
            'node_count': 1,
            'initial_data_storage_size_in_gb': 256,
            'compute_model': 'OCPU',
            'compute_count': 4,
            'db_version': '19.27.0.0',
            'pdb_name': 'pdbNameSep05',
            'db_system_option_storage_management': 'LVM',
            })

    def test_create_db_system(self):
        self.cmd(
            'az oracle-database db-system create '
            '--name {db_system_name} '
            '--resource-group {resource_group} '
            '--location {location} '
            '--zones {zone} '
            '--database-edition {database_edition} '
            '--admin-password {admin_password} '
            '--resource-anchor-id {resource_anchor_id} '
            '--network-anchor-id {network_anchor_id} '
            '--hostname {hostname} '
            '--shape {shape} '
            '--display-name {display_name} '
            '--node-count {node_count} '
            '--initial-data-storage-size-in-gb {initial_data_storage_size_in_gb} '
            '--compute-model {compute_model} '
            '--compute-count {compute_count} '
            '--db-version {db_version} '
            '--pdb-name {pdb_name} '
            '--db-system-options storage-management={db_system_option_storage_management} '
            '--ssh-public-keys \'ssh-rsa xxxx\' '
            '--no-wait'
        )
        # Show
        self.cmd(
            'az oracle-database db-system show '
            '--name {db_system_name} '
            '--resource-group {resource_group} '
        )

        # List
        self.cmd(
            'az oracle-database db-system list '
            '--resource-group {resource_group} '
        )