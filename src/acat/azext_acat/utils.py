# --------------------------------------------------------------------------------------------
# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License. See License.txt in the project root for license information.
#
# Code generated by aaz-dev-tools
# --------------------------------------------------------------------------------------------


import datetime


def ParseSubsFromResources(resourceList):
    """Parse subscriptions from resources"""
    subs = set()
    for resource in resourceList:
        sub = resource.resource_id.to_serialized_data().split("/")[2]
        subs.add(sub)
    return list(subs)


def GetClosestFullHour():
    """Get closest full hour"""
    now = datetime.datetime.now()
    return str(
        now.replace(minute=0, second=0, microsecond=0) + datetime.timedelta(hours=1)
    )


def saveArrayAsCsv(arr, fullpath):
    import csv

    with open(fullpath, "w", encoding='utf8') as out:
        csv_writer = csv.writer(out, lineterminator="\n")
        csv_writer.writerow(arr[0].keys())
        for obj in arr:
            csv_writer.writerow(obj.values())
