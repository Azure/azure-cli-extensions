# --------------------------------------------------------------------------------------------
# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License. See License.txt in the project root for license information.
#
# Code generated by aaz-dev-tools
# --------------------------------------------------------------------------------------------

from azure.cli.testsdk import ScenarioTest, ResourceGroupPreparer, KeyVaultPreparer, JMESPathCheck


class LoadScenario(ScenarioTest):
    location = 'westus2'
    identity_name1 = 'clitestid1'
    identity_name2 = 'clitestid2'
    cmk_key1 = 'testkey1'
    cmk_key2 = 'testkey2'

    @ResourceGroupPreparer(name_prefix='cli_test_azure_load_testing', location=location)
    @KeyVaultPreparer(location=location)
    def test_load_create(self, resource_group, key_vault):
        loadtest_resource_name = self.create_random_name('load-test', 24)
        self.kwargs.update({
            'subscription_id': self.get_subscription_id(),
            'resource_name': loadtest_resource_name,
            'location': self.location,
            'identity_name1': self.identity_name1,
            'identity_name2': self.identity_name2,
        })

        create_checks = [JMESPathCheck('name', loadtest_resource_name),
                         JMESPathCheck('location', self.location_name),
                         JMESPathCheck('resourceGroup', resource_group),
                         JMESPathCheck('provisioningState', 'Succeeded'),
                         JMESPathCheck('type', 'microsoft.loadtestservice/loadtests'),
                         JMESPathCheck('identity.type', 'None')]

        self.cmd('az load create --name {resource_name} --location {location} '
                '--resource-group {rg}',
                checks=create_checks)
