# --------------------------------------------------------------------------------------------
# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License. See License.txt in the project root for license information.
#
# Code generated by aaz-dev-tools
# --------------------------------------------------------------------------------------------

# pylint: skip-file
# flake8: noqa

from azure.cli.core.aaz import *


@register_command(
    "dataprotection backup-instance validate-for-restore",
    is_experimental=True,
)
class ValidateForRestore(AAZCommand):
    """Validates if Restore can be triggered for a DataSource

    :example: Validate Restore
        az dataprotection backup-instance validate-for-restore-g sample_rg --vault-name sample_backupvault --backup-instance-name sample_biname-fd53a211-3f3e-4c7e-ba45-81050e27c0be --restore-request-object restorerequestobject.json
    """

    _aaz_info = {
        "version": "2023-05-01",
        "resources": [
            ["mgmt-plane", "/subscriptions/{}/resourcegroups/{}/providers/microsoft.dataprotection/backupvaults/{}/backupinstances/{}/validaterestore", "2023-05-01"],
        ]
    }

    AZ_SUPPORT_NO_WAIT = True

    def _handler(self, command_args):
        super()._handler(command_args)
        return self.build_lro_poller(self._execute_operations, self._output)

    _args_schema = None

    @classmethod
    def _build_arguments_schema(cls, *args, **kwargs):
        if cls._args_schema is not None:
            return cls._args_schema
        cls._args_schema = super()._build_arguments_schema(*args, **kwargs)

        # define Arg Group ""

        _args_schema = cls._args_schema
        _args_schema.backup_instance_name = AAZStrArg(
            options=["-n", "--name", "--backup-instance-name"],
            help="The name of the backup instance.",
            required=True,
            id_part="child_name_1",
        )
        _args_schema.resource_group = AAZResourceGroupNameArg(
            required=True,
        )
        _args_schema.vault_name = AAZStrArg(
            options=["-v", "--vault-name"],
            help="The name of the backup vault.",
            required=True,
            id_part="name",
        )

        # define Arg Group "Parameters"

        _args_schema = cls._args_schema
        _args_schema.restore_request_object = AAZObjectArg(
            options=["--restore-request-object"],
            arg_group="Parameters",
            help="Gets or sets the restore request object.",
            required=True,
        )

        restore_request_object = cls._args_schema.restore_request_object
        restore_request_object.azure_backup_recovery_point_based_restore_request = AAZObjectArg(
            options=["azure-backup-recovery-point-based-restore-request"],
        )
        restore_request_object.azure_backup_recovery_time_based_restore_request = AAZObjectArg(
            options=["azure-backup-recovery-time-based-restore-request"],
        )
        restore_request_object.azure_backup_restore_with_rehydration_request = AAZObjectArg(
            options=["azure-backup-restore-with-rehydration-request"],
        )
        restore_request_object.identity_details = AAZObjectArg(
            options=["identity-details"],
            help="Contains information of the Identity Details for the BI. If it is null, default will be considered as System Assigned.",
        )
        restore_request_object.restore_target_info = AAZObjectArg(
            options=["restore-target-info"],
            help="Gets or sets the restore target information.",
            required=True,
        )
        restore_request_object.source_data_store_type = AAZStrArg(
            options=["source-data-store-type"],
            help="Gets or sets the type of the source data store.",
            required=True,
            enum={"ArchiveStore": "ArchiveStore", "OperationalStore": "OperationalStore", "SnapshotStore": "SnapshotStore", "VaultStore": "VaultStore"},
        )
        restore_request_object.source_resource_id = AAZStrArg(
            options=["source-resource-id"],
            help="Fully qualified Azure Resource Manager ID of the datasource which is being recovered.",
        )

        azure_backup_recovery_point_based_restore_request = cls._args_schema.restore_request_object.azure_backup_recovery_point_based_restore_request
        azure_backup_recovery_point_based_restore_request.recovery_point_id = AAZStrArg(
            options=["recovery-point-id"],
            required=True,
        )

        azure_backup_recovery_time_based_restore_request = cls._args_schema.restore_request_object.azure_backup_recovery_time_based_restore_request
        azure_backup_recovery_time_based_restore_request.recovery_point_time = AAZStrArg(
            options=["recovery-point-time"],
            help="The recovery time in ISO 8601 format example - 2020-08-14T17:30:00.0000000Z.",
            required=True,
        )

        azure_backup_restore_with_rehydration_request = cls._args_schema.restore_request_object.azure_backup_restore_with_rehydration_request
        azure_backup_restore_with_rehydration_request.recovery_point_id = AAZStrArg(
            options=["recovery-point-id"],
            required=True,
        )
        azure_backup_restore_with_rehydration_request.rehydration_priority = AAZStrArg(
            options=["rehydration-priority"],
            help="Priority to be used for rehydration. Values High or Standard",
            required=True,
            enum={"High": "High", "Invalid": "Invalid", "Standard": "Standard"},
        )
        azure_backup_restore_with_rehydration_request.rehydration_retention_duration = AAZStrArg(
            options=["rehydration-retention-duration"],
            help="Retention duration in ISO 8601 format i.e P10D .",
            required=True,
        )

        identity_details = cls._args_schema.restore_request_object.identity_details
        identity_details.use_system_assigned_identity = AAZBoolArg(
            options=["use-system-assigned-identity"],
            help="Specifies if the BI is protected by System Identity.",
        )
        identity_details.user_assigned_identity_arm_url = AAZStrArg(
            options=["user-assigned-identity-arm-url"],
            help="ARM URL for User Assigned Identity.",
        )

        restore_target_info = cls._args_schema.restore_request_object.restore_target_info
        restore_target_info.item_level_restore_target_info = AAZObjectArg(
            options=["item-level-restore-target-info"],
        )
        restore_target_info.restore_files_target_info = AAZObjectArg(
            options=["restore-files-target-info"],
        )
        restore_target_info.restore_target_info = AAZObjectArg(
            options=["restore-target-info"],
        )
        restore_target_info.recovery_option = AAZStrArg(
            options=["recovery-option"],
            help="Recovery Option",
            required=True,
            enum={"FailIfExists": "FailIfExists"},
        )
        restore_target_info.restore_location = AAZStrArg(
            options=["restore-location"],
            help="Target Restore region",
        )

        item_level_restore_target_info = cls._args_schema.restore_request_object.restore_target_info.item_level_restore_target_info
        item_level_restore_target_info.datasource_auth_credentials = AAZObjectArg(
            options=["datasource-auth-credentials"],
            help="Credentials to use to authenticate with data source provider.",
        )
        cls._build_args_auth_credentials_create(item_level_restore_target_info.datasource_auth_credentials)
        item_level_restore_target_info.datasource_info = AAZObjectArg(
            options=["datasource-info"],
            help="Information of target DS",
            required=True,
        )
        cls._build_args_datasource_create(item_level_restore_target_info.datasource_info)
        item_level_restore_target_info.datasource_set_info = AAZObjectArg(
            options=["datasource-set-info"],
            help="Information of target DS Set",
        )
        cls._build_args_datasource_set_create(item_level_restore_target_info.datasource_set_info)
        item_level_restore_target_info.restore_criteria = AAZListArg(
            options=["restore-criteria"],
            help="Restore Criteria",
            required=True,
        )

        restore_criteria = cls._args_schema.restore_request_object.restore_target_info.item_level_restore_target_info.restore_criteria
        restore_criteria.Element = AAZObjectArg()

        _element = cls._args_schema.restore_request_object.restore_target_info.item_level_restore_target_info.restore_criteria.Element
        _element.item_path_based_restore_criteria = AAZObjectArg(
            options=["item-path-based-restore-criteria"],
        )
        _element.kubernetes_cluster_restore_criteria = AAZObjectArg(
            options=["kubernetes-cluster-restore-criteria"],
        )
        _element.kubernetes_pv_restore_criteria = AAZObjectArg(
            options=["kubernetes-pv-restore-criteria"],
        )
        _element.kubernetes_storage_class_restore_criteria = AAZObjectArg(
            options=["kubernetes-storage-class-restore-criteria"],
        )
        _element.range_based_item_level_restore_criteria = AAZObjectArg(
            options=["range-based-item-level-restore-criteria"],
        )

        item_path_based_restore_criteria = cls._args_schema.restore_request_object.restore_target_info.item_level_restore_target_info.restore_criteria.Element.item_path_based_restore_criteria
        item_path_based_restore_criteria.is_path_relative_to_backup_item = AAZBoolArg(
            options=["is-path-relative-to-backup-item"],
            help="Flag to specify if the path is relative to backup item or full path",
            required=True,
        )
        item_path_based_restore_criteria.item_path = AAZStrArg(
            options=["item-path"],
            help="The path of the item to be restored. It could be the full path of the item or the path relative to the backup item",
            required=True,
        )
        item_path_based_restore_criteria.sub_item_path_prefix = AAZListArg(
            options=["sub-item-path-prefix"],
            help="The list of prefix strings to be used as filter criteria during restore. These are relative to the item path specified.",
        )

        sub_item_path_prefix = cls._args_schema.restore_request_object.restore_target_info.item_level_restore_target_info.restore_criteria.Element.item_path_based_restore_criteria.sub_item_path_prefix
        sub_item_path_prefix.Element = AAZStrArg()

        kubernetes_cluster_restore_criteria = cls._args_schema.restore_request_object.restore_target_info.item_level_restore_target_info.restore_criteria.Element.kubernetes_cluster_restore_criteria
        kubernetes_cluster_restore_criteria.conflict_policy = AAZStrArg(
            options=["conflict-policy"],
            help="Gets or sets the Conflict Policy property. This property sets policy during conflict of resources during restore.",
            enum={"Patch": "Patch", "Skip": "Skip"},
        )
        kubernetes_cluster_restore_criteria.excluded_namespaces = AAZListArg(
            options=["excluded-namespaces"],
            help="Gets or sets the exclude namespaces property. This property sets the namespaces to be excluded during restore.",
        )
        kubernetes_cluster_restore_criteria.excluded_resource_types = AAZListArg(
            options=["excluded-resource-types"],
            help="Gets or sets the exclude resource types property. This property sets the resource types to be excluded during restore.",
        )
        kubernetes_cluster_restore_criteria.include_cluster_scope_resources = AAZBoolArg(
            options=["include-cluster-scope-resources"],
            help="Gets or sets the include cluster resources property. This property if enabled will include cluster scope resources during restore.",
            required=True,
        )
        kubernetes_cluster_restore_criteria.included_namespaces = AAZListArg(
            options=["included-namespaces"],
            help="Gets or sets the include namespaces property. This property sets the namespaces to be included during restore.",
        )
        kubernetes_cluster_restore_criteria.included_resource_types = AAZListArg(
            options=["included-resource-types"],
            help="Gets or sets the include resource types property. This property sets the resource types to be included during restore.",
        )
        kubernetes_cluster_restore_criteria.label_selectors = AAZListArg(
            options=["label-selectors"],
            help="Gets or sets the LabelSelectors property. This property sets the resource with such label selectors to be included during restore.",
        )
        kubernetes_cluster_restore_criteria.namespace_mappings = AAZDictArg(
            options=["namespace-mappings"],
            help="Gets or sets the Namespace Mappings property. This property sets if namespace needs to be change during restore.",
        )
        kubernetes_cluster_restore_criteria.persistent_volume_restore_mode = AAZStrArg(
            options=["persistent-volume-restore-mode"],
            help="Gets or sets the PV (Persistent Volume) Restore Mode property. This property sets whether volumes needs to be restored.",
            enum={"RestoreWithVolumeData": "RestoreWithVolumeData", "RestoreWithoutVolumeData": "RestoreWithoutVolumeData"},
        )
        kubernetes_cluster_restore_criteria.restore_hook_references = AAZListArg(
            options=["restore-hook-references"],
            help="Gets or sets the restore hook references. This property sets the hook reference to be executed during restore.",
        )

        excluded_namespaces = cls._args_schema.restore_request_object.restore_target_info.item_level_restore_target_info.restore_criteria.Element.kubernetes_cluster_restore_criteria.excluded_namespaces
        excluded_namespaces.Element = AAZStrArg()

        excluded_resource_types = cls._args_schema.restore_request_object.restore_target_info.item_level_restore_target_info.restore_criteria.Element.kubernetes_cluster_restore_criteria.excluded_resource_types
        excluded_resource_types.Element = AAZStrArg()

        included_namespaces = cls._args_schema.restore_request_object.restore_target_info.item_level_restore_target_info.restore_criteria.Element.kubernetes_cluster_restore_criteria.included_namespaces
        included_namespaces.Element = AAZStrArg()

        included_resource_types = cls._args_schema.restore_request_object.restore_target_info.item_level_restore_target_info.restore_criteria.Element.kubernetes_cluster_restore_criteria.included_resource_types
        included_resource_types.Element = AAZStrArg()

        label_selectors = cls._args_schema.restore_request_object.restore_target_info.item_level_restore_target_info.restore_criteria.Element.kubernetes_cluster_restore_criteria.label_selectors
        label_selectors.Element = AAZStrArg()

        namespace_mappings = cls._args_schema.restore_request_object.restore_target_info.item_level_restore_target_info.restore_criteria.Element.kubernetes_cluster_restore_criteria.namespace_mappings
        namespace_mappings.Element = AAZStrArg()

        restore_hook_references = cls._args_schema.restore_request_object.restore_target_info.item_level_restore_target_info.restore_criteria.Element.kubernetes_cluster_restore_criteria.restore_hook_references
        restore_hook_references.Element = AAZObjectArg()

        _element = cls._args_schema.restore_request_object.restore_target_info.item_level_restore_target_info.restore_criteria.Element.kubernetes_cluster_restore_criteria.restore_hook_references.Element
        _element.name = AAZStrArg(
            options=["name"],
            help="Name of the resource",
        )
        _element.namespace = AAZStrArg(
            options=["namespace"],
            help="Namespace in which the resource exists",
        )

        kubernetes_pv_restore_criteria = cls._args_schema.restore_request_object.restore_target_info.item_level_restore_target_info.restore_criteria.Element.kubernetes_pv_restore_criteria
        kubernetes_pv_restore_criteria.name = AAZStrArg(
            options=["name"],
            help="Selected persistent volume claim name",
        )
        kubernetes_pv_restore_criteria.storage_class_name = AAZStrArg(
            options=["storage-class-name"],
            help="Selected storage class name for restore operation",
        )

        kubernetes_storage_class_restore_criteria = cls._args_schema.restore_request_object.restore_target_info.item_level_restore_target_info.restore_criteria.Element.kubernetes_storage_class_restore_criteria
        kubernetes_storage_class_restore_criteria.provisioner = AAZStrArg(
            options=["provisioner"],
            help="Provisioner of the storage class",
        )
        kubernetes_storage_class_restore_criteria.selected_storage_class_name = AAZStrArg(
            options=["selected-storage-class-name"],
            help="Selected storage class name",
        )

        range_based_item_level_restore_criteria = cls._args_schema.restore_request_object.restore_target_info.item_level_restore_target_info.restore_criteria.Element.range_based_item_level_restore_criteria
        range_based_item_level_restore_criteria.max_matching_value = AAZStrArg(
            options=["max-matching-value"],
            help="maximum value for range prefix match",
        )
        range_based_item_level_restore_criteria.min_matching_value = AAZStrArg(
            options=["min-matching-value"],
            help="minimum value for range prefix match",
        )

        restore_files_target_info = cls._args_schema.restore_request_object.restore_target_info.restore_files_target_info
        restore_files_target_info.target_details = AAZObjectArg(
            options=["target-details"],
            help="Destination of RestoreAsFiles operation, when destination is not a datasource",
            required=True,
        )

        target_details = cls._args_schema.restore_request_object.restore_target_info.restore_files_target_info.target_details
        target_details.file_prefix = AAZStrArg(
            options=["file-prefix"],
            help="Restore operation may create multiple files inside location pointed by Url Below will be the common prefix for all of them",
            required=True,
        )
        target_details.restore_target_location_type = AAZStrArg(
            options=["restore-target-location-type"],
            help="Denotes the target location where the data will be restored, string value for the enum {Microsoft.Internal.AzureBackup.DataProtection.Common.Interface.RestoreTargetLocationType}",
            required=True,
            enum={"AzureBlobs": "AzureBlobs", "AzureFiles": "AzureFiles", "Invalid": "Invalid"},
        )
        target_details.target_resource_arm_id = AAZStrArg(
            options=["target-resource-arm-id"],
            help="Full ARM Id denoting the restore destination. It is the ARM Id pointing to container / file share. This is optional if the target subscription can be identified with the URL field. If not then this is needed if CrossSubscriptionRestore field of BackupVault is in any of the disabled states",
        )
        target_details.url = AAZStrArg(
            options=["url"],
            help="Url denoting the restore destination. It can point to container / file share etc",
            required=True,
        )

        restore_target_info = cls._args_schema.restore_request_object.restore_target_info.restore_target_info
        restore_target_info.datasource_auth_credentials = AAZObjectArg(
            options=["datasource-auth-credentials"],
            help="Credentials to use to authenticate with data source provider.",
        )
        cls._build_args_auth_credentials_create(restore_target_info.datasource_auth_credentials)
        restore_target_info.datasource_info = AAZObjectArg(
            options=["datasource-info"],
            help="Information of target DS",
            required=True,
        )
        cls._build_args_datasource_create(restore_target_info.datasource_info)
        restore_target_info.datasource_set_info = AAZObjectArg(
            options=["datasource-set-info"],
            help="Information of target DS Set",
        )
        cls._build_args_datasource_set_create(restore_target_info.datasource_set_info)
        return cls._args_schema

    _args_auth_credentials_create = None

    @classmethod
    def _build_args_auth_credentials_create(cls, _schema):
        if cls._args_auth_credentials_create is not None:
            _schema.secret_store_based_auth_credentials = cls._args_auth_credentials_create.secret_store_based_auth_credentials
            return

        cls._args_auth_credentials_create = AAZObjectArg()

        auth_credentials_create = cls._args_auth_credentials_create
        auth_credentials_create.secret_store_based_auth_credentials = AAZObjectArg(
            options=["secret-store-based-auth-credentials"],
        )

        secret_store_based_auth_credentials = cls._args_auth_credentials_create.secret_store_based_auth_credentials
        secret_store_based_auth_credentials.secret_store_resource = AAZObjectArg(
            options=["secret-store-resource"],
            help="Secret store resource",
        )

        secret_store_resource = cls._args_auth_credentials_create.secret_store_based_auth_credentials.secret_store_resource
        secret_store_resource.secret_store_type = AAZStrArg(
            options=["secret-store-type"],
            help="Gets or sets the type of secret store",
            required=True,
            enum={"AzureKeyVault": "AzureKeyVault", "Invalid": "Invalid"},
        )
        secret_store_resource.uri = AAZStrArg(
            options=["uri"],
            help="Uri to get to the resource",
        )
        secret_store_resource.value = AAZStrArg(
            options=["value"],
            help="Gets or sets value stored in secret store resource",
        )

        _schema.secret_store_based_auth_credentials = cls._args_auth_credentials_create.secret_store_based_auth_credentials

    _args_base_resource_properties_create = None

    @classmethod
    def _build_args_base_resource_properties_create(cls, _schema):
        if cls._args_base_resource_properties_create is not None:
            _schema.object_type = cls._args_base_resource_properties_create.object_type
            return

        cls._args_base_resource_properties_create = AAZObjectArg()

        base_resource_properties_create = cls._args_base_resource_properties_create
        base_resource_properties_create.object_type = AAZStrArg(
            options=["object-type"],
            help="Type of the specific object - used for deserializing",
            required=True,
            enum={"DefaultResourceProperties": "DefaultResourceProperties"},
        )

        _schema.object_type = cls._args_base_resource_properties_create.object_type

    _args_datasource_set_create = None

    @classmethod
    def _build_args_datasource_set_create(cls, _schema):
        if cls._args_datasource_set_create is not None:
            _schema.datasource_type = cls._args_datasource_set_create.datasource_type
            _schema.object_type = cls._args_datasource_set_create.object_type
            _schema.resource_id = cls._args_datasource_set_create.resource_id
            _schema.resource_location = cls._args_datasource_set_create.resource_location
            _schema.resource_name = cls._args_datasource_set_create.resource_name
            _schema.resource_properties = cls._args_datasource_set_create.resource_properties
            _schema.resource_type = cls._args_datasource_set_create.resource_type
            _schema.resource_uri = cls._args_datasource_set_create.resource_uri
            return

        cls._args_datasource_set_create = AAZObjectArg()

        datasource_set_create = cls._args_datasource_set_create
        datasource_set_create.datasource_type = AAZStrArg(
            options=["datasource-type"],
            help="DatasourceType of the resource.",
        )
        datasource_set_create.object_type = AAZStrArg(
            options=["object-type"],
            help="Type of Datasource object, used to initialize the right inherited type",
        )
        datasource_set_create.resource_id = AAZStrArg(
            options=["resource-id"],
            help="Full ARM ID of the resource. For azure resources, this is ARM ID. For non azure resources, this will be the ID created by backup service via Fabric/Vault.",
            required=True,
        )
        datasource_set_create.resource_location = AAZStrArg(
            options=["resource-location"],
            help="Location of datasource.",
        )
        datasource_set_create.resource_name = AAZStrArg(
            options=["resource-name"],
            help="Unique identifier of the resource in the context of parent.",
        )
        datasource_set_create.resource_properties = AAZObjectArg(
            options=["resource-properties"],
            help="Properties specific to data source set",
        )
        cls._build_args_base_resource_properties_create(datasource_set_create.resource_properties)
        datasource_set_create.resource_type = AAZStrArg(
            options=["resource-type"],
            help="Resource Type of Datasource.",
        )
        datasource_set_create.resource_uri = AAZStrArg(
            options=["resource-uri"],
            help="Uri of the resource.",
        )

        _schema.datasource_type = cls._args_datasource_set_create.datasource_type
        _schema.object_type = cls._args_datasource_set_create.object_type
        _schema.resource_id = cls._args_datasource_set_create.resource_id
        _schema.resource_location = cls._args_datasource_set_create.resource_location
        _schema.resource_name = cls._args_datasource_set_create.resource_name
        _schema.resource_properties = cls._args_datasource_set_create.resource_properties
        _schema.resource_type = cls._args_datasource_set_create.resource_type
        _schema.resource_uri = cls._args_datasource_set_create.resource_uri

    _args_datasource_create = None

    @classmethod
    def _build_args_datasource_create(cls, _schema):
        if cls._args_datasource_create is not None:
            _schema.datasource_type = cls._args_datasource_create.datasource_type
            _schema.object_type = cls._args_datasource_create.object_type
            _schema.resource_id = cls._args_datasource_create.resource_id
            _schema.resource_location = cls._args_datasource_create.resource_location
            _schema.resource_name = cls._args_datasource_create.resource_name
            _schema.resource_properties = cls._args_datasource_create.resource_properties
            _schema.resource_type = cls._args_datasource_create.resource_type
            _schema.resource_uri = cls._args_datasource_create.resource_uri
            return

        cls._args_datasource_create = AAZObjectArg()

        datasource_create = cls._args_datasource_create
        datasource_create.datasource_type = AAZStrArg(
            options=["datasource-type"],
            help="DatasourceType of the resource.",
        )
        datasource_create.object_type = AAZStrArg(
            options=["object-type"],
            help="Type of Datasource object, used to initialize the right inherited type",
        )
        datasource_create.resource_id = AAZStrArg(
            options=["resource-id"],
            help="Full ARM ID of the resource. For azure resources, this is ARM ID. For non azure resources, this will be the ID created by backup service via Fabric/Vault.",
            required=True,
        )
        datasource_create.resource_location = AAZStrArg(
            options=["resource-location"],
            help="Location of datasource.",
        )
        datasource_create.resource_name = AAZStrArg(
            options=["resource-name"],
            help="Unique identifier of the resource in the context of parent.",
        )
        datasource_create.resource_properties = AAZObjectArg(
            options=["resource-properties"],
            help="Properties specific to data source",
        )
        cls._build_args_base_resource_properties_create(datasource_create.resource_properties)
        datasource_create.resource_type = AAZStrArg(
            options=["resource-type"],
            help="Resource Type of Datasource.",
        )
        datasource_create.resource_uri = AAZStrArg(
            options=["resource-uri"],
            help="Uri of the resource.",
        )

        _schema.datasource_type = cls._args_datasource_create.datasource_type
        _schema.object_type = cls._args_datasource_create.object_type
        _schema.resource_id = cls._args_datasource_create.resource_id
        _schema.resource_location = cls._args_datasource_create.resource_location
        _schema.resource_name = cls._args_datasource_create.resource_name
        _schema.resource_properties = cls._args_datasource_create.resource_properties
        _schema.resource_type = cls._args_datasource_create.resource_type
        _schema.resource_uri = cls._args_datasource_create.resource_uri

    def _execute_operations(self):
        self.pre_operations()
        yield self.BackupInstancesValidateForRestore(ctx=self.ctx)()
        self.post_operations()

    @register_callback
    def pre_operations(self):
        pass

    @register_callback
    def post_operations(self):
        pass

    def _output(self, *args, **kwargs):
        result = self.deserialize_output(self.ctx.vars.instance, client_flatten=True)
        return result

    class BackupInstancesValidateForRestore(AAZHttpOperation):
        CLIENT_TYPE = "MgmtClient"

        def __call__(self, *args, **kwargs):
            request = self.make_request()
            session = self.client.send_request(request=request, stream=False, **kwargs)
            if session.http_response.status_code in [202]:
                return self.client.build_lro_polling(
                    self.ctx.args.no_wait,
                    session,
                    self.on_200,
                    self.on_error,
                    lro_options={"final-state-via": "location"},
                    path_format_arguments=self.url_parameters,
                )
            if session.http_response.status_code in [200]:
                return self.client.build_lro_polling(
                    self.ctx.args.no_wait,
                    session,
                    self.on_200,
                    self.on_error,
                    lro_options={"final-state-via": "location"},
                    path_format_arguments=self.url_parameters,
                )

            return self.on_error(session.http_response)

        @property
        def url(self):
            return self.client.format_url(
                "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.DataProtection/backupVaults/{vaultName}/backupInstances/{backupInstanceName}/validateRestore",
                **self.url_parameters
            )

        @property
        def method(self):
            return "POST"

        @property
        def error_format(self):
            return "MgmtErrorFormat"

        @property
        def url_parameters(self):
            parameters = {
                **self.serialize_url_param(
                    "backupInstanceName", self.ctx.args.backup_instance_name,
                    required=True,
                ),
                **self.serialize_url_param(
                    "resourceGroupName", self.ctx.args.resource_group,
                    required=True,
                ),
                **self.serialize_url_param(
                    "subscriptionId", self.ctx.subscription_id,
                    required=True,
                ),
                **self.serialize_url_param(
                    "vaultName", self.ctx.args.vault_name,
                    required=True,
                ),
            }
            return parameters

        @property
        def query_parameters(self):
            parameters = {
                **self.serialize_query_param(
                    "api-version", "2023-05-01",
                    required=True,
                ),
            }
            return parameters

        @property
        def header_parameters(self):
            parameters = {
                **self.serialize_header_param(
                    "Content-Type", "application/json",
                ),
                **self.serialize_header_param(
                    "Accept", "application/json",
                ),
            }
            return parameters

        @property
        def content(self):
            _content_value, _builder = self.new_content_builder(
                self.ctx.args,
                typ=AAZObjectType,
                typ_kwargs={"flags": {"required": True, "client_flatten": True}}
            )
            _builder.set_prop("restoreRequestObject", AAZObjectType, ".restore_request_object", typ_kwargs={"flags": {"required": True}})

            restore_request_object = _builder.get(".restoreRequestObject")
            if restore_request_object is not None:
                restore_request_object.set_prop("identityDetails", AAZObjectType, ".identity_details")
                restore_request_object.set_const("objectType", "AzureBackupRecoveryPointBasedRestoreRequest", AAZStrType, ".azure_backup_recovery_point_based_restore_request", typ_kwargs={"flags": {"required": True}})
                restore_request_object.set_const("objectType", "AzureBackupRecoveryTimeBasedRestoreRequest", AAZStrType, ".azure_backup_recovery_time_based_restore_request", typ_kwargs={"flags": {"required": True}})
                restore_request_object.set_const("objectType", "AzureBackupRestoreWithRehydrationRequest", AAZStrType, ".azure_backup_restore_with_rehydration_request", typ_kwargs={"flags": {"required": True}})
                restore_request_object.set_prop("restoreTargetInfo", AAZObjectType, ".restore_target_info", typ_kwargs={"flags": {"required": True}})
                restore_request_object.set_prop("sourceDataStoreType", AAZStrType, ".source_data_store_type", typ_kwargs={"flags": {"required": True}})
                restore_request_object.set_prop("sourceResourceId", AAZStrType, ".source_resource_id")
                restore_request_object.discriminate_by("objectType", "AzureBackupRecoveryPointBasedRestoreRequest")
                restore_request_object.discriminate_by("objectType", "AzureBackupRecoveryTimeBasedRestoreRequest")
                restore_request_object.discriminate_by("objectType", "AzureBackupRestoreWithRehydrationRequest")

            identity_details = _builder.get(".restoreRequestObject.identityDetails")
            if identity_details is not None:
                identity_details.set_prop("useSystemAssignedIdentity", AAZBoolType, ".use_system_assigned_identity")
                identity_details.set_prop("userAssignedIdentityArmUrl", AAZStrType, ".user_assigned_identity_arm_url")

            restore_target_info = _builder.get(".restoreRequestObject.restoreTargetInfo")
            if restore_target_info is not None:
                restore_target_info.set_const("objectType", "ItemLevelRestoreTargetInfo", AAZStrType, ".item_level_restore_target_info", typ_kwargs={"flags": {"required": True}})
                restore_target_info.set_const("objectType", "RestoreFilesTargetInfo", AAZStrType, ".restore_files_target_info", typ_kwargs={"flags": {"required": True}})
                restore_target_info.set_const("objectType", "RestoreTargetInfo", AAZStrType, ".restore_target_info", typ_kwargs={"flags": {"required": True}})
                restore_target_info.set_prop("recoveryOption", AAZStrType, ".recovery_option", typ_kwargs={"flags": {"required": True}})
                restore_target_info.set_prop("restoreLocation", AAZStrType, ".restore_location")
                restore_target_info.discriminate_by("objectType", "ItemLevelRestoreTargetInfo")
                restore_target_info.discriminate_by("objectType", "RestoreFilesTargetInfo")
                restore_target_info.discriminate_by("objectType", "RestoreTargetInfo")

            disc_item_level_restore_target_info = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:ItemLevelRestoreTargetInfo}")
            if disc_item_level_restore_target_info is not None:
                _ValidateForRestoreHelper._build_schema_auth_credentials_create(disc_item_level_restore_target_info.set_prop("datasourceAuthCredentials", AAZObjectType, ".item_level_restore_target_info.datasource_auth_credentials"))
                _ValidateForRestoreHelper._build_schema_datasource_create(disc_item_level_restore_target_info.set_prop("datasourceInfo", AAZObjectType, ".item_level_restore_target_info.datasource_info", typ_kwargs={"flags": {"required": True}}))
                _ValidateForRestoreHelper._build_schema_datasource_set_create(disc_item_level_restore_target_info.set_prop("datasourceSetInfo", AAZObjectType, ".item_level_restore_target_info.datasource_set_info"))
                disc_item_level_restore_target_info.set_prop("restoreCriteria", AAZListType, ".item_level_restore_target_info.restore_criteria", typ_kwargs={"flags": {"required": True}})

            restore_criteria = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:ItemLevelRestoreTargetInfo}.restoreCriteria")
            if restore_criteria is not None:
                restore_criteria.set_elements(AAZObjectType, ".")

            _elements = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:ItemLevelRestoreTargetInfo}.restoreCriteria[]")
            if _elements is not None:
                _elements.set_const("objectType", "ItemPathBasedRestoreCriteria", AAZStrType, ".item_path_based_restore_criteria", typ_kwargs={"flags": {"required": True}})
                _elements.set_const("objectType", "KubernetesClusterRestoreCriteria", AAZStrType, ".kubernetes_cluster_restore_criteria", typ_kwargs={"flags": {"required": True}})
                _elements.set_const("objectType", "KubernetesPVRestoreCriteria", AAZStrType, ".kubernetes_pv_restore_criteria", typ_kwargs={"flags": {"required": True}})
                _elements.set_const("objectType", "KubernetesStorageClassRestoreCriteria", AAZStrType, ".kubernetes_storage_class_restore_criteria", typ_kwargs={"flags": {"required": True}})
                _elements.set_const("objectType", "RangeBasedItemLevelRestoreCriteria", AAZStrType, ".range_based_item_level_restore_criteria", typ_kwargs={"flags": {"required": True}})
                _elements.discriminate_by("objectType", "ItemPathBasedRestoreCriteria")
                _elements.discriminate_by("objectType", "KubernetesClusterRestoreCriteria")
                _elements.discriminate_by("objectType", "KubernetesPVRestoreCriteria")
                _elements.discriminate_by("objectType", "KubernetesStorageClassRestoreCriteria")
                _elements.discriminate_by("objectType", "RangeBasedItemLevelRestoreCriteria")

            disc_item_path_based_restore_criteria = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:ItemLevelRestoreTargetInfo}.restoreCriteria[]{objectType:ItemPathBasedRestoreCriteria}")
            if disc_item_path_based_restore_criteria is not None:
                disc_item_path_based_restore_criteria.set_prop("isPathRelativeToBackupItem", AAZBoolType, ".item_path_based_restore_criteria.is_path_relative_to_backup_item", typ_kwargs={"flags": {"required": True}})
                disc_item_path_based_restore_criteria.set_prop("itemPath", AAZStrType, ".item_path_based_restore_criteria.item_path", typ_kwargs={"flags": {"required": True}})
                disc_item_path_based_restore_criteria.set_prop("subItemPathPrefix", AAZListType, ".item_path_based_restore_criteria.sub_item_path_prefix")

            sub_item_path_prefix = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:ItemLevelRestoreTargetInfo}.restoreCriteria[]{objectType:ItemPathBasedRestoreCriteria}.subItemPathPrefix")
            if sub_item_path_prefix is not None:
                sub_item_path_prefix.set_elements(AAZStrType, ".")

            disc_kubernetes_cluster_restore_criteria = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:ItemLevelRestoreTargetInfo}.restoreCriteria[]{objectType:KubernetesClusterRestoreCriteria}")
            if disc_kubernetes_cluster_restore_criteria is not None:
                disc_kubernetes_cluster_restore_criteria.set_prop("conflictPolicy", AAZStrType, ".kubernetes_cluster_restore_criteria.conflict_policy")
                disc_kubernetes_cluster_restore_criteria.set_prop("excludedNamespaces", AAZListType, ".kubernetes_cluster_restore_criteria.excluded_namespaces")
                disc_kubernetes_cluster_restore_criteria.set_prop("excludedResourceTypes", AAZListType, ".kubernetes_cluster_restore_criteria.excluded_resource_types")
                disc_kubernetes_cluster_restore_criteria.set_prop("includeClusterScopeResources", AAZBoolType, ".kubernetes_cluster_restore_criteria.include_cluster_scope_resources", typ_kwargs={"flags": {"required": True}})
                disc_kubernetes_cluster_restore_criteria.set_prop("includedNamespaces", AAZListType, ".kubernetes_cluster_restore_criteria.included_namespaces")
                disc_kubernetes_cluster_restore_criteria.set_prop("includedResourceTypes", AAZListType, ".kubernetes_cluster_restore_criteria.included_resource_types")
                disc_kubernetes_cluster_restore_criteria.set_prop("labelSelectors", AAZListType, ".kubernetes_cluster_restore_criteria.label_selectors")
                disc_kubernetes_cluster_restore_criteria.set_prop("namespaceMappings", AAZDictType, ".kubernetes_cluster_restore_criteria.namespace_mappings")
                disc_kubernetes_cluster_restore_criteria.set_prop("persistentVolumeRestoreMode", AAZStrType, ".kubernetes_cluster_restore_criteria.persistent_volume_restore_mode")
                disc_kubernetes_cluster_restore_criteria.set_prop("restoreHookReferences", AAZListType, ".kubernetes_cluster_restore_criteria.restore_hook_references")

            excluded_namespaces = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:ItemLevelRestoreTargetInfo}.restoreCriteria[]{objectType:KubernetesClusterRestoreCriteria}.excludedNamespaces")
            if excluded_namespaces is not None:
                excluded_namespaces.set_elements(AAZStrType, ".")

            excluded_resource_types = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:ItemLevelRestoreTargetInfo}.restoreCriteria[]{objectType:KubernetesClusterRestoreCriteria}.excludedResourceTypes")
            if excluded_resource_types is not None:
                excluded_resource_types.set_elements(AAZStrType, ".")

            included_namespaces = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:ItemLevelRestoreTargetInfo}.restoreCriteria[]{objectType:KubernetesClusterRestoreCriteria}.includedNamespaces")
            if included_namespaces is not None:
                included_namespaces.set_elements(AAZStrType, ".")

            included_resource_types = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:ItemLevelRestoreTargetInfo}.restoreCriteria[]{objectType:KubernetesClusterRestoreCriteria}.includedResourceTypes")
            if included_resource_types is not None:
                included_resource_types.set_elements(AAZStrType, ".")

            label_selectors = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:ItemLevelRestoreTargetInfo}.restoreCriteria[]{objectType:KubernetesClusterRestoreCriteria}.labelSelectors")
            if label_selectors is not None:
                label_selectors.set_elements(AAZStrType, ".")

            namespace_mappings = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:ItemLevelRestoreTargetInfo}.restoreCriteria[]{objectType:KubernetesClusterRestoreCriteria}.namespaceMappings")
            if namespace_mappings is not None:
                namespace_mappings.set_elements(AAZStrType, ".")

            restore_hook_references = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:ItemLevelRestoreTargetInfo}.restoreCriteria[]{objectType:KubernetesClusterRestoreCriteria}.restoreHookReferences")
            if restore_hook_references is not None:
                restore_hook_references.set_elements(AAZObjectType, ".")

            _elements = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:ItemLevelRestoreTargetInfo}.restoreCriteria[]{objectType:KubernetesClusterRestoreCriteria}.restoreHookReferences[]")
            if _elements is not None:
                _elements.set_prop("name", AAZStrType, ".name")
                _elements.set_prop("namespace", AAZStrType, ".namespace")

            disc_kubernetes_pv_restore_criteria = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:ItemLevelRestoreTargetInfo}.restoreCriteria[]{objectType:KubernetesPVRestoreCriteria}")
            if disc_kubernetes_pv_restore_criteria is not None:
                disc_kubernetes_pv_restore_criteria.set_prop("name", AAZStrType, ".kubernetes_pv_restore_criteria.name")
                disc_kubernetes_pv_restore_criteria.set_prop("storageClassName", AAZStrType, ".kubernetes_pv_restore_criteria.storage_class_name")

            disc_kubernetes_storage_class_restore_criteria = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:ItemLevelRestoreTargetInfo}.restoreCriteria[]{objectType:KubernetesStorageClassRestoreCriteria}")
            if disc_kubernetes_storage_class_restore_criteria is not None:
                disc_kubernetes_storage_class_restore_criteria.set_prop("provisioner", AAZStrType, ".kubernetes_storage_class_restore_criteria.provisioner")
                disc_kubernetes_storage_class_restore_criteria.set_prop("selectedStorageClassName", AAZStrType, ".kubernetes_storage_class_restore_criteria.selected_storage_class_name")

            disc_range_based_item_level_restore_criteria = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:ItemLevelRestoreTargetInfo}.restoreCriteria[]{objectType:RangeBasedItemLevelRestoreCriteria}")
            if disc_range_based_item_level_restore_criteria is not None:
                disc_range_based_item_level_restore_criteria.set_prop("maxMatchingValue", AAZStrType, ".range_based_item_level_restore_criteria.max_matching_value")
                disc_range_based_item_level_restore_criteria.set_prop("minMatchingValue", AAZStrType, ".range_based_item_level_restore_criteria.min_matching_value")

            disc_restore_files_target_info = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:RestoreFilesTargetInfo}")
            if disc_restore_files_target_info is not None:
                disc_restore_files_target_info.set_prop("targetDetails", AAZObjectType, ".restore_files_target_info.target_details", typ_kwargs={"flags": {"required": True}})

            target_details = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:RestoreFilesTargetInfo}.targetDetails")
            if target_details is not None:
                target_details.set_prop("filePrefix", AAZStrType, ".file_prefix", typ_kwargs={"flags": {"required": True}})
                target_details.set_prop("restoreTargetLocationType", AAZStrType, ".restore_target_location_type", typ_kwargs={"flags": {"required": True}})
                target_details.set_prop("targetResourceArmId", AAZStrType, ".target_resource_arm_id")
                target_details.set_prop("url", AAZStrType, ".url", typ_kwargs={"flags": {"required": True}})

            disc_restore_target_info = _builder.get(".restoreRequestObject.restoreTargetInfo{objectType:RestoreTargetInfo}")
            if disc_restore_target_info is not None:
                _ValidateForRestoreHelper._build_schema_auth_credentials_create(disc_restore_target_info.set_prop("datasourceAuthCredentials", AAZObjectType, ".restore_target_info.datasource_auth_credentials"))
                _ValidateForRestoreHelper._build_schema_datasource_create(disc_restore_target_info.set_prop("datasourceInfo", AAZObjectType, ".restore_target_info.datasource_info", typ_kwargs={"flags": {"required": True}}))
                _ValidateForRestoreHelper._build_schema_datasource_set_create(disc_restore_target_info.set_prop("datasourceSetInfo", AAZObjectType, ".restore_target_info.datasource_set_info"))

            disc_azure_backup_recovery_point_based_restore_request = _builder.get(".restoreRequestObject{objectType:AzureBackupRecoveryPointBasedRestoreRequest}")
            if disc_azure_backup_recovery_point_based_restore_request is not None:
                disc_azure_backup_recovery_point_based_restore_request.set_prop("recoveryPointId", AAZStrType, ".azure_backup_recovery_point_based_restore_request.recovery_point_id", typ_kwargs={"flags": {"required": True}})

            disc_azure_backup_recovery_time_based_restore_request = _builder.get(".restoreRequestObject{objectType:AzureBackupRecoveryTimeBasedRestoreRequest}")
            if disc_azure_backup_recovery_time_based_restore_request is not None:
                disc_azure_backup_recovery_time_based_restore_request.set_prop("recoveryPointTime", AAZStrType, ".azure_backup_recovery_time_based_restore_request.recovery_point_time", typ_kwargs={"flags": {"required": True}})

            disc_azure_backup_restore_with_rehydration_request = _builder.get(".restoreRequestObject{objectType:AzureBackupRestoreWithRehydrationRequest}")
            if disc_azure_backup_restore_with_rehydration_request is not None:
                disc_azure_backup_restore_with_rehydration_request.set_prop("recoveryPointId", AAZStrType, ".azure_backup_restore_with_rehydration_request.recovery_point_id", typ_kwargs={"flags": {"required": True}})
                disc_azure_backup_restore_with_rehydration_request.set_prop("rehydrationPriority", AAZStrType, ".azure_backup_restore_with_rehydration_request.rehydration_priority", typ_kwargs={"flags": {"required": True}})
                disc_azure_backup_restore_with_rehydration_request.set_prop("rehydrationRetentionDuration", AAZStrType, ".azure_backup_restore_with_rehydration_request.rehydration_retention_duration", typ_kwargs={"flags": {"required": True}})

            return self.serialize_content(_content_value)

        def on_200(self, session):
            data = self.deserialize_http_content(session)
            self.ctx.set_var(
                "instance",
                data,
                schema_builder=self._build_schema_on_200
            )

        _schema_on_200 = None

        @classmethod
        def _build_schema_on_200(cls):
            if cls._schema_on_200 is not None:
                return cls._schema_on_200

            cls._schema_on_200 = AAZObjectType()

            _schema_on_200 = cls._schema_on_200
            _schema_on_200.job_id = AAZStrType(
                serialized_name="jobId",
            )
            _schema_on_200.object_type = AAZStrType(
                serialized_name="objectType",
                flags={"required": True},
            )

            return cls._schema_on_200


class _ValidateForRestoreHelper:
    """Helper class for ValidateForRestore"""

    @classmethod
    def _build_schema_auth_credentials_create(cls, _builder):
        if _builder is None:
            return
        _builder.set_const("objectType", "SecretStoreBasedAuthCredentials", AAZStrType, ".secret_store_based_auth_credentials", typ_kwargs={"flags": {"required": True}})
        _builder.discriminate_by("objectType", "SecretStoreBasedAuthCredentials")

        disc_secret_store_based_auth_credentials = _builder.get("{objectType:SecretStoreBasedAuthCredentials}")
        if disc_secret_store_based_auth_credentials is not None:
            disc_secret_store_based_auth_credentials.set_prop("secretStoreResource", AAZObjectType, ".secret_store_based_auth_credentials.secret_store_resource")

        secret_store_resource = _builder.get("{objectType:SecretStoreBasedAuthCredentials}.secretStoreResource")
        if secret_store_resource is not None:
            secret_store_resource.set_prop("secretStoreType", AAZStrType, ".secret_store_type", typ_kwargs={"flags": {"required": True}})
            secret_store_resource.set_prop("uri", AAZStrType, ".uri")
            secret_store_resource.set_prop("value", AAZStrType, ".value")

    @classmethod
    def _build_schema_base_resource_properties_create(cls, _builder):
        if _builder is None:
            return
        _builder.set_prop("objectType", AAZStrType, ".object_type", typ_kwargs={"flags": {"required": True}})

    @classmethod
    def _build_schema_datasource_set_create(cls, _builder):
        if _builder is None:
            return
        _builder.set_prop("datasourceType", AAZStrType, ".datasource_type")
        _builder.set_prop("objectType", AAZStrType, ".object_type")
        _builder.set_prop("resourceID", AAZStrType, ".resource_id", typ_kwargs={"flags": {"required": True}})
        _builder.set_prop("resourceLocation", AAZStrType, ".resource_location")
        _builder.set_prop("resourceName", AAZStrType, ".resource_name")
        cls._build_schema_base_resource_properties_create(_builder.set_prop("resourceProperties", AAZObjectType, ".resource_properties"))
        _builder.set_prop("resourceType", AAZStrType, ".resource_type")
        _builder.set_prop("resourceUri", AAZStrType, ".resource_uri")

    @classmethod
    def _build_schema_datasource_create(cls, _builder):
        if _builder is None:
            return
        _builder.set_prop("datasourceType", AAZStrType, ".datasource_type")
        _builder.set_prop("objectType", AAZStrType, ".object_type")
        _builder.set_prop("resourceID", AAZStrType, ".resource_id", typ_kwargs={"flags": {"required": True}})
        _builder.set_prop("resourceLocation", AAZStrType, ".resource_location")
        _builder.set_prop("resourceName", AAZStrType, ".resource_name")
        cls._build_schema_base_resource_properties_create(_builder.set_prop("resourceProperties", AAZObjectType, ".resource_properties"))
        _builder.set_prop("resourceType", AAZStrType, ".resource_type")
        _builder.set_prop("resourceUri", AAZStrType, ".resource_uri")


__all__ = ["ValidateForRestore"]
