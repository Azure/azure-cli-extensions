# --------------------------------------------------------------------------
# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License. See License.txt in the project root for
# license information.
#
# Code generated by Microsoft (R) AutoRest Code Generator.
# Changes may cause incorrect behavior and will be lost if the code is
# regenerated.
# --------------------------------------------------------------------------
# ---------------------------------------------------------
from knack.log import get_logger

from .raise_error import log_and_raise_error
from .utils import _dump_entity_with_warnings, get_ml_client

module_logger = get_logger(__name__)


def ml_azure_openai_deployment_list(cmd, resource_group_name, workspace_name, connection_name):
    ml_client, debug = get_ml_client(
        cli_ctx=cmd.cli_ctx, resource_group_name=resource_group_name, workspace_name=workspace_name
    )

    try:
        return [
            _dump_entity_with_warnings(deployment)
            for deployment in ml_client.azure_openai_deployments.list(connection_name)
        ]
    except Exception as err:  # pylint: disable=broad-exception-caught
        log_and_raise_error(err, debug)
