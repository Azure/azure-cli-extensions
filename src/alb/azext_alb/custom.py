# --------------------------------------------------------------------------------------------
# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License. See License.txt in the project root for license information.
#
# Code generated by aaz-dev-tools
# --------------------------------------------------------------------------------------------

# pylint: disable=too-many-lines
# pylint: disable=too-many-statements, protected-access

from knack.log import get_logger
from azure.cli.core.aaz import register_command
from .aaz.latest.network.alb.association import Create as _AssociationCreate
from .aaz.latest.network.alb.security_policy import Create as _SPCreate, Delete as _SPDelete, Update as _SPUpdate

logger = get_logger(__name__)


class AssociationCreate(_AssociationCreate):
    @classmethod
    def _build_arguments_schema(cls, *args, **kwargs):
        from azure.cli.core.aaz import AAZStrArg, AAZResourceIdArgFormat
        args_schema = super()._build_arguments_schema(*args, **kwargs)
        args_schema.vnet_name = AAZStrArg(
            options=["--vnet-name"],
            arg_group="Properties",
            help="Name of the virtual network corresponding to the subnet."
        )
        args_schema.subnet._fmt = AAZResourceIdArgFormat(
            template="/subscriptions/{subscription}/resourceGroups/{resource_group}/providers/Microsoft.Network"
                     "/virtualNetworks/{vnet_name}/subnets/{}",
        )
        return args_schema


@register_command("network alb security-policy waf create")
class WafSecurityPolicyCreate(_SPCreate):
    """Create a Waf SecurityPolicy

    :example: Create an Application Gateway for Containers security policy resource with waf policy type
        az network alb security-policy waf create -g test-rg --alb-name test-tc -n test-sp -l NorthCentralUS
        --waf-policy-id "/subscriptions/subid/resourcegroups/rg1/providers/Microsoft.Networking/wafpolicy/test-wp"
    """


@register_command(
    "network alb security-policy waf delete",
    confirmation="Are you sure you want to perform this operation?",
)
class WafSecurityPolicyDelete(_SPDelete):
    """Delete a Waf SecurityPolicy

    :example: Delete a Waf SecurityPolicy
        az network alb security-policy waf delete -g test-rg --alb-name test-tc -n test-sp
    """


@register_command("network alb security-policy waf update")
class WafSecurityPolicyUpdate(_SPUpdate):
    """Update a Waf SecurityPolicy

    :example: Update a Waf SecurityPolicy
        az network alb security-policy waf update -g test-rg --alb-name test-tc -n test-sp
        --waf-policy-id "/subscriptions/subid/resourcegroups/rg1/providers/Microsoft.Networking/wafpolicy/test-wp"
    """
