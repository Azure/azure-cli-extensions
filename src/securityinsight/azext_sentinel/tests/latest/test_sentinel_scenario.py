# --------------------------------------------------------------------------
# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License. See License.txt in the project root for
# license information.
#
# Code generated by Microsoft (R) AutoRest Code Generator.
# Changes may cause incorrect behavior and will be lost if the code is
# regenerated.
# --------------------------------------------------------------------------

import os
import unittest

from azure_devtools.scenario_tests import AllowLargeResponse
from azure.cli.testsdk import ScenarioTest
from .. import try_manual
from azure.cli.testsdk import ResourceGroupPreparer


TEST_DIR = os.path.abspath(os.path.join(os.path.abspath(__file__), '..'))


@try_manual
def setup(test, rg):
    pass


# EXAMPLE: /Actions/get/Get all actions of alert rule.
@try_manual
def step__actions_get_get_all_actions_of_alert_rule_(test, rg):
    test.cmd('az sentinel action list '
             '--resource-group "{rg}" '
             '--rule-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /AlertRules/put/Creates or updates a Fusion alert rule.
@try_manual
def step__alertrules_put_creates_or_updates_a_fusion_alert_rule_(test, rg):
    test.cmd('az sentinel alert-rule create '
             '--etag "3d00c3ca-0000-0100-0000-5d42d5010000" '
             '--kind "Fusion" '
             '--resource-group "{rg}" '
             '--rule-id "myFirstFusionRule" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /AlertRules/put/Creates or updates a MicrosoftSecurityIncidentCreation rule.
@try_manual
def step__alertrules_put_creates_or_updates_a_microsoftsecurityincidentcreation_rule_(test, rg):
    test.cmd('az sentinel alert-rule create '
             '--etag "\\"260097e0-0000-0d00-0000-5d6fa88f0000\\"" '
             '--kind "MicrosoftSecurityIncidentCreation" '
             '--resource-group "{rg}" '
             '--rule-id "microsoftSecurityIncidentCreationRuleExample" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /AlertRules/put/Creates or updates a Scheduled alert rule.
@try_manual
def step__alertrules_put_creates_or_updates_a_scheduled_alert_rule_(test, rg):
    test.cmd('az sentinel alert-rule create '
             '--etag "\\"0300bf09-0000-0000-0000-5c37296e0000\\"" '
             '--kind "Scheduled" '
             '--resource-group "{rg}" '
             '--rule-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /AlertRules/put/Creates or updates an action of alert rule.
@try_manual
def step__alertrules_put_creates_or_updates_an_action_of_alert_rule_(test, rg):
    test.cmd('az sentinel alert-rule create '
             '--etag "\\"0300bf09-0000-0000-0000-5c37296e0000\\"" '
             '--logic-app-resource-id "/subscriptions/{subscription_id}/resourceGroups/{rg}/providers/Microsoft.Logic/w'
             'orkflows/MyAlerts" '
             '--trigger-uri "https://prod-31.northcentralus.logic.azure.com:443/workflows/cd3765391efd48549fd7681ded1d4'
             '8d7/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=signatur'
             'e" '
             '--action-id "912bec42-cb66-4c03-ac63-1761b6898c3e" '
             '--resource-group "{rg}" '
             '--rule-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /AlertRules/get/Get a Fusion alert rule.
@try_manual
def step__alertrules_get_get_a_fusion_alert_rule_(test, rg):
    test.cmd('az sentinel alert-rule show '
             '--resource-group "{rg}" '
             '--rule-id "myFirstFusionRule" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /AlertRules/get/Get a MicrosoftSecurityIncidentCreation rule.
@try_manual
def step__alertrules_get_get_a_microsoftsecurityincidentcreation_rule_(test, rg):
    test.cmd('az sentinel alert-rule show '
             '--resource-group "{rg}" '
             '--rule-id "microsoftSecurityIncidentCreationRuleExample" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /AlertRules/get/Get a Scheduled alert rule.
@try_manual
def step__alertrules_get_get_a_scheduled_alert_rule_(test, rg):
    test.cmd('az sentinel alert-rule show '
             '--resource-group "{rg}" '
             '--rule-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /AlertRules/get/Get all alert rules.
@try_manual
def step__alertrules_get_get_all_alert_rules_(test, rg):
    test.cmd('az sentinel alert-rule list '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /AlertRules/get/Get an action of alert rule.
@try_manual
def step__alertrules_get_get_an_action_of_alert_rule_(test, rg):
    test.cmd('az sentinel alert-rule show '
             '--action-id "912bec42-cb66-4c03-ac63-1761b6898c3e" '
             '--resource-group "{rg}" '
             '--rule-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /DataConnectors/put/Creates or updates an Office365 data connector.
@try_manual
def step__dataconnectors_put_creates_or_updates_an_office365_data_connector_(test, rg):
    test.cmd('az sentinel data-connector create '
             '--etag "\\"0300bf09-0000-0000-0000-5c37296e0000\\"" '
             '--kind "Office365" '
             '--data-connector-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /DataConnectors/get/Get a ASC data connector.
@try_manual
def step__dataconnectors_get_get_a_asc_data_connector_(test, rg):
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "763f9fa1-c2d3-4fa2-93e9-bccd4899aa12" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /DataConnectors/get/Get a MCAS data connector.
@try_manual
def step__dataconnectors_get_get_a_mcas_data_connector_(test, rg):
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "b96d014d-b5c2-4a01-9aba-a8058f629d42" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /DataConnectors/get/Get a MDATP data connector
@try_manual
def step__dataconnectors_get_get_a_mdatp_data_connector(test, rg):
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "06b3ccb8-1384-4bcc-aec7-852f6d57161b" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /DataConnectors/get/Get a TI data connector.
@try_manual
def step__dataconnectors_get_get_a_ti_data_connector_(test, rg):
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "c345bf40-8509-4ed2-b947-50cb773aaf04" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /DataConnectors/get/Get all data connectors.
@try_manual
def step__dataconnectors_get_get_all_data_connectors_(test, rg):
    test.cmd('az sentinel data-connector list '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /DataConnectors/get/Get an AAD data connector.
@try_manual
def step__dataconnectors_get_get_an_aad_data_connector_(test, rg):
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "f0cd27d2-5f03-4c06-ba31-d2dc82dcb51d" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /DataConnectors/get/Get an AATP data connector.
@try_manual
def step__dataconnectors_get_get_an_aatp_data_connector_(test, rg):
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "07e42cb3-e658-4e90-801c-efa0f29d3d44" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /DataConnectors/get/Get an AwsCloudTrail data connector.
@try_manual
def step__dataconnectors_get_get_an_awscloudtrail_data_connector_(test, rg):
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "c345bf40-8509-4ed2-b947-50cb773aaf04" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /DataConnectors/get/Get an Office365 data connector.
@try_manual
def step__dataconnectors_get_get_an_office365_data_connector_(test, rg):
    test.cmd('az sentinel data-connector show '
             '--data-connector-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /AlertRules/delete/Delete an alert rule.
@try_manual
def step__alertrules_delete_delete_an_alert_rule_(test, rg):
    test.cmd('az sentinel alert-rule delete '
             '--resource-group "{rg}" '
             '--rule-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /AlertRules/delete/Delete an action of alert rule.
@try_manual
def step__alertrules_delete_delete_an_action_of_alert_rule_(test, rg):
    test.cmd('az sentinel alert-rule delete '
             '--action-id "912bec42-cb66-4c03-ac63-1761b6898c3e" '
             '--resource-group "{rg}" '
             '--rule-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--workspace-name "myWorkspace"',
             checks=[])


# EXAMPLE: /DataConnectors/delete/Delete an Office365 data connector.
@try_manual
def step__dataconnectors_delete_delete_an_office365_data_connector_(test, rg):
    test.cmd('az sentinel data-connector delete '
             '--data-connector-id "73e01a99-5cd7-4139-a149-9f2736ff2ab5" '
             '--resource-group "{rg}" '
             '--workspace-name "myWorkspace"',
             checks=[])


@try_manual
def cleanup(test, rg):
    pass


@try_manual
def call_scenario(test, rg):
    setup(test, rg)
    step__actions_get_get_all_actions_of_alert_rule_(test, rg)
    step__alertrules_put_creates_or_updates_a_fusion_alert_rule_(test, rg)
    step__alertrules_put_creates_or_updates_a_microsoftsecurityincidentcreation_rule_(test, rg)
    step__alertrules_put_creates_or_updates_a_scheduled_alert_rule_(test, rg)
    step__alertrules_put_creates_or_updates_an_action_of_alert_rule_(test, rg)
    step__alertrules_get_get_a_fusion_alert_rule_(test, rg)
    step__alertrules_get_get_a_microsoftsecurityincidentcreation_rule_(test, rg)
    step__alertrules_get_get_a_scheduled_alert_rule_(test, rg)
    step__alertrules_get_get_all_alert_rules_(test, rg)
    step__alertrules_get_get_an_action_of_alert_rule_(test, rg)
    step__dataconnectors_put_creates_or_updates_an_office365_data_connector_(test, rg)
    step__dataconnectors_get_get_a_asc_data_connector_(test, rg)
    step__dataconnectors_get_get_a_mcas_data_connector_(test, rg)
    step__dataconnectors_get_get_a_mdatp_data_connector(test, rg)
    step__dataconnectors_get_get_a_ti_data_connector_(test, rg)
    step__dataconnectors_get_get_all_data_connectors_(test, rg)
    step__dataconnectors_get_get_an_aad_data_connector_(test, rg)
    step__dataconnectors_get_get_an_aatp_data_connector_(test, rg)
    step__dataconnectors_get_get_an_awscloudtrail_data_connector_(test, rg)
    step__dataconnectors_get_get_an_office365_data_connector_(test, rg)
    step__alertrules_delete_delete_an_alert_rule_(test, rg)
    step__alertrules_delete_delete_an_action_of_alert_rule_(test, rg)
    step__dataconnectors_delete_delete_an_office365_data_connector_(test, rg)
    cleanup(test, rg)


@try_manual
class SecurityInsightsScenarioTest(ScenarioTest):

    @ResourceGroupPreparer(name_prefix='clitestsentinel_myRg'[:7], key='rg', parameter_name='rg')
    def test_sentinel(self, rg):

        self.kwargs.update({
            'subscription_id': self.get_subscription_id()
        })

        call_scenario(self, rg)
