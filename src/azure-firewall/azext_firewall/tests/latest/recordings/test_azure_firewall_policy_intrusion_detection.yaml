interactions:
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy create
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n --sku --idps-mode
      User-Agent:
      - AZURECLI/2.50.0 azsdk-python-azure-mgmt-resource/23.1.0b2 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/test_azure_firewall_policy_intrusion_detection000001?api-version=2022-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001","name":"test_azure_firewall_policy_intrusion_detection000001","type":"Microsoft.Resources/resourceGroups","location":"westus","tags":{"product":"azurecli","cause":"automation","test":"test_azure_firewall_policy_intrusion_detection","date":"2023-08-04T08:54:17Z","module":"azure-firewall"},"properties":{"provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '464'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:54:21 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "westus", "properties": {"intrusionDetection": {"mode": "Off"},
      "sku": {"tier": "Premium"}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy create
      Connection:
      - keep-alive
      Content-Length:
      - '105'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g -n --sku --idps-mode
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"intrusionDetection\": {\r\n      \"mode\": \"Off\"\r\n    },\r\n  \
        \  \"provisioningState\": \"Updating\"\r\n  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"762a59d3-0b58-41a2-9377-9ba1213c1fe2\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/nfvOperations/5e734c93-ed00-4bad-9ec4-9a7f2313b28f?api-version=2022-01-01
      cache-control:
      - no-cache
      content-length:
      - '634'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:54:25 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1199'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy create
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n --sku --idps-mode
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/nfvOperations/5e734c93-ed00-4bad-9ec4-9a7f2313b28f?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"status\": \"Succeeded\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '29'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:54:25 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy create
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n --sku --idps-mode
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"intrusionDetection\": {\r\n      \"mode\": \"Off\"\r\n    },\r\n  \
        \  \"provisioningState\": \"Succeeded\"\r\n  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"762a59d3-0b58-41a2-9377-9ba1213c1fe2\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '635'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:54:26 GMT
      etag:
      - '"762a59d3-0b58-41a2-9377-9ba1213c1fe2"'
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy update
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n --idps-mode
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"intrusionDetection\": {\r\n      \"mode\": \"Off\"\r\n    },\r\n  \
        \  \"provisioningState\": \"Succeeded\"\r\n  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"762a59d3-0b58-41a2-9377-9ba1213c1fe2\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '635'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:54:28 GMT
      etag:
      - '"762a59d3-0b58-41a2-9377-9ba1213c1fe2"'
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy",
      "location": "westus", "properties": {"intrusionDetection": {"mode": "Alert"},
      "sku": {"tier": "Premium"}, "threatIntelMode": "Alert"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy update
      Connection:
      - keep-alive
      Content-Length:
      - '326'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g -n --idps-mode
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"intrusionDetection\": {\r\n      \"mode\": \"Alert\"\r\n    },\r\n\
        \    \"provisioningState\": \"Updating\"\r\n  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"baf56fea-acd4-47e0-8dc1-778ea1924475\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/nfvOperations/53adef9c-2b8d-457e-b127-c26a5b92cd2a?api-version=2022-01-01
      cache-control:
      - no-cache
      content-length:
      - '636'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:54:29 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1198'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy update
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n --idps-mode
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/nfvOperations/53adef9c-2b8d-457e-b127-c26a5b92cd2a?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"status\": \"InProgress\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '30'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:54:29 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy update
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n --idps-mode
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/nfvOperations/53adef9c-2b8d-457e-b127-c26a5b92cd2a?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"status\": \"Succeeded\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '29'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:54:41 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy update
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n --idps-mode
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"intrusionDetection\": {\r\n      \"mode\": \"Alert\"\r\n    },\r\n\
        \    \"provisioningState\": \"Succeeded\"\r\n  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"baf56fea-acd4-47e0-8dc1-778ea1924475\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '637'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:54:41 GMT
      etag:
      - '"baf56fea-acd4-47e0-8dc1-778ea1924475"'
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --mode --signature-id --private-ranges
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"intrusionDetection\": {\r\n      \"mode\": \"Alert\"\r\n    },\r\n\
        \    \"provisioningState\": \"Succeeded\"\r\n  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"baf56fea-acd4-47e0-8dc1-778ea1924475\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '637'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:54:42 GMT
      etag:
      - '"baf56fea-acd4-47e0-8dc1-778ea1924475"'
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy",
      "location": "westus", "properties": {"intrusionDetection": {"configuration":
      {"privateRanges": ["167.220.204.0/24", "167.221.205.101/32"], "signatureOverrides":
      [{"id": "10001", "mode": "Deny"}]}, "mode": "Alert"}, "sku": {"tier": "Premium"},
      "snat": {"privateRanges": ["167.220.204.0/24", "167.221.205.101/32"]}, "threatIntelMode":
      "Alert"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection add
      Connection:
      - keep-alive
      Content-Length:
      - '534'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name --mode --signature-id --private-ranges
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"snat\": {\r\n      \"privateRanges\": [\r\n        \"167.220.204.0/24\"\
        ,\r\n        \"167.221.205.101/32\"\r\n      ]\r\n    },\r\n    \"intrusionDetection\"\
        : {\r\n      \"mode\": \"Alert\",\r\n      \"configuration\": {\r\n      \
        \  \"signatureOverrides\": [\r\n          {\r\n            \"id\": \"10001\"\
        ,\r\n            \"mode\": \"Deny\"\r\n          }\r\n        ],\r\n     \
        \   \"bypassTrafficSettings\": [],\r\n        \"privateRanges\": [\r\n   \
        \       \"167.220.204.0/24\",\r\n          \"167.221.205.101/32\"\r\n    \
        \    ]\r\n      }\r\n    },\r\n    \"provisioningState\": \"Updating\"\r\n\
        \  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"bb593c6b-64e7-4c2f-aace-7331d7f5ee51\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/nfvOperations/551033f1-c7ff-420f-9774-1e6e3fc631b6?api-version=2022-01-01
      cache-control:
      - no-cache
      content-length:
      - '1056'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:54:43 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1199'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --mode --signature-id --private-ranges
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/nfvOperations/551033f1-c7ff-420f-9774-1e6e3fc631b6?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"status\": \"InProgress\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '30'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:54:43 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --mode --signature-id --private-ranges
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/nfvOperations/551033f1-c7ff-420f-9774-1e6e3fc631b6?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"status\": \"Succeeded\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '29'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:54:54 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --mode --signature-id --private-ranges
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"snat\": {\r\n      \"privateRanges\": [\r\n        \"167.220.204.0/24\"\
        ,\r\n        \"167.221.205.101/32\"\r\n      ]\r\n    },\r\n    \"intrusionDetection\"\
        : {\r\n      \"mode\": \"Alert\",\r\n      \"configuration\": {\r\n      \
        \  \"signatureOverrides\": [\r\n          {\r\n            \"id\": \"10001\"\
        ,\r\n            \"mode\": \"Deny\"\r\n          }\r\n        ],\r\n     \
        \   \"bypassTrafficSettings\": [],\r\n        \"privateRanges\": [\r\n   \
        \       \"167.220.204.0/24\",\r\n          \"167.221.205.101/32\"\r\n    \
        \    ]\r\n      }\r\n    },\r\n    \"provisioningState\": \"Succeeded\"\r\n\
        \  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"bb593c6b-64e7-4c2f-aace-7331d7f5ee51\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1057'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:54:55 GMT
      etag:
      - '"bb593c6b-64e7-4c2f-aace-7331d7f5ee51"'
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --mode --signature-id --private-ranges
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"snat\": {\r\n      \"privateRanges\": [\r\n        \"167.220.204.0/24\"\
        ,\r\n        \"167.221.205.101/32\"\r\n      ]\r\n    },\r\n    \"intrusionDetection\"\
        : {\r\n      \"mode\": \"Alert\",\r\n      \"configuration\": {\r\n      \
        \  \"signatureOverrides\": [\r\n          {\r\n            \"id\": \"10001\"\
        ,\r\n            \"mode\": \"Deny\"\r\n          }\r\n        ],\r\n     \
        \   \"bypassTrafficSettings\": [],\r\n        \"privateRanges\": [\r\n   \
        \       \"167.220.204.0/24\",\r\n          \"167.221.205.101/32\"\r\n    \
        \    ]\r\n      }\r\n    },\r\n    \"provisioningState\": \"Succeeded\"\r\n\
        \  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"bb593c6b-64e7-4c2f-aace-7331d7f5ee51\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1057'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:54:57 GMT
      etag:
      - '"bb593c6b-64e7-4c2f-aace-7331d7f5ee51"'
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy",
      "location": "westus", "properties": {"intrusionDetection": {"configuration":
      {"bypassTrafficSettings": [], "privateRanges": ["167.220.208.0/24", "167.221.205.102/32"],
      "signatureOverrides": [{"id": "10001", "mode": "Deny"}, {"id": "20001", "mode":
      "Alert"}]}, "mode": "Alert"}, "sku": {"tier": "Premium"}, "snat": {"privateRanges":
      ["167.220.208.0/24", "167.221.205.102/32"]}, "threatIntelMode": "Alert"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection add
      Connection:
      - keep-alive
      Content-Length:
      - '597'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name --mode --signature-id --private-ranges
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"snat\": {\r\n      \"privateRanges\": [\r\n        \"167.220.208.0/24\"\
        ,\r\n        \"167.221.205.102/32\"\r\n      ]\r\n    },\r\n    \"intrusionDetection\"\
        : {\r\n      \"mode\": \"Alert\",\r\n      \"configuration\": {\r\n      \
        \  \"signatureOverrides\": [\r\n          {\r\n            \"id\": \"10001\"\
        ,\r\n            \"mode\": \"Deny\"\r\n          },\r\n          {\r\n   \
        \         \"id\": \"20001\",\r\n            \"mode\": \"Alert\"\r\n      \
        \    }\r\n        ],\r\n        \"bypassTrafficSettings\": [],\r\n       \
        \ \"privateRanges\": [\r\n          \"167.220.208.0/24\",\r\n          \"\
        167.221.205.102/32\"\r\n        ]\r\n      }\r\n    },\r\n    \"provisioningState\"\
        : \"Updating\"\r\n  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"1a5aea8a-bf7e-4152-86b0-d3e357b21457\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/nfvOperations/9b2b37c2-7fb5-401c-bd9c-c166449aaf9f?api-version=2022-01-01
      cache-control:
      - no-cache
      content-length:
      - '1140'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:54:58 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1199'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --mode --signature-id --private-ranges
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/nfvOperations/9b2b37c2-7fb5-401c-bd9c-c166449aaf9f?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"status\": \"InProgress\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '30'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:54:59 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --mode --signature-id --private-ranges
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/nfvOperations/9b2b37c2-7fb5-401c-bd9c-c166449aaf9f?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"status\": \"Succeeded\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '29'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:55:09 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --mode --signature-id --private-ranges
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"snat\": {\r\n      \"privateRanges\": [\r\n        \"167.220.208.0/24\"\
        ,\r\n        \"167.221.205.102/32\"\r\n      ]\r\n    },\r\n    \"intrusionDetection\"\
        : {\r\n      \"mode\": \"Alert\",\r\n      \"configuration\": {\r\n      \
        \  \"signatureOverrides\": [\r\n          {\r\n            \"id\": \"10001\"\
        ,\r\n            \"mode\": \"Deny\"\r\n          },\r\n          {\r\n   \
        \         \"id\": \"20001\",\r\n            \"mode\": \"Alert\"\r\n      \
        \    }\r\n        ],\r\n        \"bypassTrafficSettings\": [],\r\n       \
        \ \"privateRanges\": [\r\n          \"167.220.208.0/24\",\r\n          \"\
        167.221.205.102/32\"\r\n        ]\r\n      }\r\n    },\r\n    \"provisioningState\"\
        : \"Succeeded\"\r\n  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"1a5aea8a-bf7e-4152-86b0-d3e357b21457\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1141'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:55:09 GMT
      etag:
      - '"1a5aea8a-bf7e-4152-86b0-d3e357b21457"'
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --rule-name --rule-protocol --rule-src-addresses --rule-dest-addresses
        --rule-dest-ports
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"snat\": {\r\n      \"privateRanges\": [\r\n        \"167.220.208.0/24\"\
        ,\r\n        \"167.221.205.102/32\"\r\n      ]\r\n    },\r\n    \"intrusionDetection\"\
        : {\r\n      \"mode\": \"Alert\",\r\n      \"configuration\": {\r\n      \
        \  \"signatureOverrides\": [\r\n          {\r\n            \"id\": \"10001\"\
        ,\r\n            \"mode\": \"Deny\"\r\n          },\r\n          {\r\n   \
        \         \"id\": \"20001\",\r\n            \"mode\": \"Alert\"\r\n      \
        \    }\r\n        ],\r\n        \"bypassTrafficSettings\": [],\r\n       \
        \ \"privateRanges\": [\r\n          \"167.220.208.0/24\",\r\n          \"\
        167.221.205.102/32\"\r\n        ]\r\n      }\r\n    },\r\n    \"provisioningState\"\
        : \"Succeeded\"\r\n  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"1a5aea8a-bf7e-4152-86b0-d3e357b21457\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1141'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:55:11 GMT
      etag:
      - '"1a5aea8a-bf7e-4152-86b0-d3e357b21457"'
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy",
      "location": "westus", "properties": {"intrusionDetection": {"configuration":
      {"bypassTrafficSettings": [{"destinationAddresses": ["192.168.0.103", "192.168.0.104"],
      "destinationPorts": ["8080", "9090", "5432"], "name": "bypass-rule-1", "protocol":
      "TCP", "sourceAddresses": ["10.0.0.12", "10.0.0.15"]}], "privateRanges": ["167.220.208.0/24",
      "167.221.205.102/32"], "signatureOverrides": [{"id": "10001", "mode": "Deny"},
      {"id": "20001", "mode": "Alert"}]}, "mode": "Alert"}, "sku": {"tier": "Premium"},
      "snat": {"privateRanges": ["167.220.208.0/24", "167.221.205.102/32"]}, "threatIntelMode":
      "Alert"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection add
      Connection:
      - keep-alive
      Content-Length:
      - '794'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name --rule-name --rule-protocol --rule-src-addresses --rule-dest-addresses
        --rule-dest-ports
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"snat\": {\r\n      \"privateRanges\": [\r\n        \"167.220.208.0/24\"\
        ,\r\n        \"167.221.205.102/32\"\r\n      ]\r\n    },\r\n    \"intrusionDetection\"\
        : {\r\n      \"mode\": \"Alert\",\r\n      \"configuration\": {\r\n      \
        \  \"signatureOverrides\": [\r\n          {\r\n            \"id\": \"10001\"\
        ,\r\n            \"mode\": \"Deny\"\r\n          },\r\n          {\r\n   \
        \         \"id\": \"20001\",\r\n            \"mode\": \"Alert\"\r\n      \
        \    }\r\n        ],\r\n        \"bypassTrafficSettings\": [\r\n         \
        \ {\r\n            \"name\": \"bypass-rule-1\",\r\n            \"protocol\"\
        : \"TCP\",\r\n            \"sourceAddresses\": [\r\n              \"10.0.0.12\"\
        ,\r\n              \"10.0.0.15\"\r\n            ],\r\n            \"destinationAddresses\"\
        : [\r\n              \"192.168.0.103\",\r\n              \"192.168.0.104\"\
        \r\n            ],\r\n            \"destinationPorts\": [\r\n            \
        \  \"8080\",\r\n              \"9090\",\r\n              \"5432\"\r\n    \
        \        ]\r\n          }\r\n        ],\r\n        \"privateRanges\": [\r\n\
        \          \"167.220.208.0/24\",\r\n          \"167.221.205.102/32\"\r\n \
        \       ]\r\n      }\r\n    },\r\n    \"provisioningState\": \"Updating\"\r\
        \n  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"060faf5b-6e6d-4cf8-b556-e8ed770fd704\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/nfvOperations/c1efee65-9628-4377-bbd3-9dcaa73847ea?api-version=2022-01-01
      cache-control:
      - no-cache
      content-length:
      - '1587'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:55:12 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1199'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --rule-name --rule-protocol --rule-src-addresses --rule-dest-addresses
        --rule-dest-ports
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/nfvOperations/c1efee65-9628-4377-bbd3-9dcaa73847ea?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"status\": \"InProgress\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '30'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:55:12 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --rule-name --rule-protocol --rule-src-addresses --rule-dest-addresses
        --rule-dest-ports
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/nfvOperations/c1efee65-9628-4377-bbd3-9dcaa73847ea?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"status\": \"Succeeded\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '29'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:55:22 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --rule-name --rule-protocol --rule-src-addresses --rule-dest-addresses
        --rule-dest-ports
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"snat\": {\r\n      \"privateRanges\": [\r\n        \"167.220.208.0/24\"\
        ,\r\n        \"167.221.205.102/32\"\r\n      ]\r\n    },\r\n    \"intrusionDetection\"\
        : {\r\n      \"mode\": \"Alert\",\r\n      \"configuration\": {\r\n      \
        \  \"signatureOverrides\": [\r\n          {\r\n            \"id\": \"10001\"\
        ,\r\n            \"mode\": \"Deny\"\r\n          },\r\n          {\r\n   \
        \         \"id\": \"20001\",\r\n            \"mode\": \"Alert\"\r\n      \
        \    }\r\n        ],\r\n        \"bypassTrafficSettings\": [\r\n         \
        \ {\r\n            \"name\": \"bypass-rule-1\",\r\n            \"protocol\"\
        : \"TCP\",\r\n            \"sourceAddresses\": [\r\n              \"10.0.0.12\"\
        ,\r\n              \"10.0.0.15\"\r\n            ],\r\n            \"destinationAddresses\"\
        : [\r\n              \"192.168.0.103\",\r\n              \"192.168.0.104\"\
        \r\n            ],\r\n            \"destinationPorts\": [\r\n            \
        \  \"8080\",\r\n              \"9090\",\r\n              \"5432\"\r\n    \
        \        ]\r\n          }\r\n        ],\r\n        \"privateRanges\": [\r\n\
        \          \"167.220.208.0/24\",\r\n          \"167.221.205.102/32\"\r\n \
        \       ]\r\n      }\r\n    },\r\n    \"provisioningState\": \"Succeeded\"\
        \r\n  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"060faf5b-6e6d-4cf8-b556-e8ed770fd704\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1588'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:55:23 GMT
      etag:
      - '"060faf5b-6e6d-4cf8-b556-e8ed770fd704"'
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection list
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"snat\": {\r\n      \"privateRanges\": [\r\n        \"167.220.208.0/24\"\
        ,\r\n        \"167.221.205.102/32\"\r\n      ]\r\n    },\r\n    \"intrusionDetection\"\
        : {\r\n      \"mode\": \"Alert\",\r\n      \"configuration\": {\r\n      \
        \  \"signatureOverrides\": [\r\n          {\r\n            \"id\": \"10001\"\
        ,\r\n            \"mode\": \"Deny\"\r\n          },\r\n          {\r\n   \
        \         \"id\": \"20001\",\r\n            \"mode\": \"Alert\"\r\n      \
        \    }\r\n        ],\r\n        \"bypassTrafficSettings\": [\r\n         \
        \ {\r\n            \"name\": \"bypass-rule-1\",\r\n            \"protocol\"\
        : \"TCP\",\r\n            \"sourceAddresses\": [\r\n              \"10.0.0.12\"\
        ,\r\n              \"10.0.0.15\"\r\n            ],\r\n            \"destinationAddresses\"\
        : [\r\n              \"192.168.0.103\",\r\n              \"192.168.0.104\"\
        \r\n            ],\r\n            \"destinationPorts\": [\r\n            \
        \  \"8080\",\r\n              \"9090\",\r\n              \"5432\"\r\n    \
        \        ]\r\n          }\r\n        ],\r\n        \"privateRanges\": [\r\n\
        \          \"167.220.208.0/24\",\r\n          \"167.221.205.102/32\"\r\n \
        \       ]\r\n      }\r\n    },\r\n    \"provisioningState\": \"Succeeded\"\
        \r\n  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"060faf5b-6e6d-4cf8-b556-e8ed770fd704\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1588'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:55:25 GMT
      etag:
      - '"060faf5b-6e6d-4cf8-b556-e8ed770fd704"'
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection remove
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --rule-name --signature-id
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"snat\": {\r\n      \"privateRanges\": [\r\n        \"167.220.208.0/24\"\
        ,\r\n        \"167.221.205.102/32\"\r\n      ]\r\n    },\r\n    \"intrusionDetection\"\
        : {\r\n      \"mode\": \"Alert\",\r\n      \"configuration\": {\r\n      \
        \  \"signatureOverrides\": [\r\n          {\r\n            \"id\": \"10001\"\
        ,\r\n            \"mode\": \"Deny\"\r\n          },\r\n          {\r\n   \
        \         \"id\": \"20001\",\r\n            \"mode\": \"Alert\"\r\n      \
        \    }\r\n        ],\r\n        \"bypassTrafficSettings\": [\r\n         \
        \ {\r\n            \"name\": \"bypass-rule-1\",\r\n            \"protocol\"\
        : \"TCP\",\r\n            \"sourceAddresses\": [\r\n              \"10.0.0.12\"\
        ,\r\n              \"10.0.0.15\"\r\n            ],\r\n            \"destinationAddresses\"\
        : [\r\n              \"192.168.0.103\",\r\n              \"192.168.0.104\"\
        \r\n            ],\r\n            \"destinationPorts\": [\r\n            \
        \  \"8080\",\r\n              \"9090\",\r\n              \"5432\"\r\n    \
        \        ]\r\n          }\r\n        ],\r\n        \"privateRanges\": [\r\n\
        \          \"167.220.208.0/24\",\r\n          \"167.221.205.102/32\"\r\n \
        \       ]\r\n      }\r\n    },\r\n    \"provisioningState\": \"Succeeded\"\
        \r\n  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"060faf5b-6e6d-4cf8-b556-e8ed770fd704\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1588'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:55:27 GMT
      etag:
      - '"060faf5b-6e6d-4cf8-b556-e8ed770fd704"'
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy",
      "location": "westus", "properties": {"intrusionDetection": {"configuration":
      {"bypassTrafficSettings": [], "privateRanges": ["167.220.208.0/24", "167.221.205.102/32"],
      "signatureOverrides": [{"id": "20001", "mode": "Alert"}]}, "mode": "Alert"},
      "sku": {"tier": "Premium"}, "snat": {"privateRanges": ["167.220.208.0/24", "167.221.205.102/32"]},
      "threatIntelMode": "Alert"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection remove
      Connection:
      - keep-alive
      Content-Length:
      - '564'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name --rule-name --signature-id
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"snat\": {\r\n      \"privateRanges\": [\r\n        \"167.220.208.0/24\"\
        ,\r\n        \"167.221.205.102/32\"\r\n      ]\r\n    },\r\n    \"intrusionDetection\"\
        : {\r\n      \"mode\": \"Alert\",\r\n      \"configuration\": {\r\n      \
        \  \"signatureOverrides\": [\r\n          {\r\n            \"id\": \"20001\"\
        ,\r\n            \"mode\": \"Alert\"\r\n          }\r\n        ],\r\n    \
        \    \"bypassTrafficSettings\": [],\r\n        \"privateRanges\": [\r\n  \
        \        \"167.220.208.0/24\",\r\n          \"167.221.205.102/32\"\r\n   \
        \     ]\r\n      }\r\n    },\r\n    \"provisioningState\": \"Updating\"\r\n\
        \  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"ba05e064-a6f0-484f-9d35-a50a692ce7e7\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/nfvOperations/5bb1d59a-b161-4979-920e-c0c72b0e9cbe?api-version=2022-01-01
      cache-control:
      - no-cache
      content-length:
      - '1057'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:55:28 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1198'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection remove
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --rule-name --signature-id
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/nfvOperations/5bb1d59a-b161-4979-920e-c0c72b0e9cbe?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"status\": \"InProgress\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '30'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:55:29 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection remove
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --rule-name --signature-id
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/nfvOperations/5bb1d59a-b161-4979-920e-c0c72b0e9cbe?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"status\": \"Succeeded\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '29'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:55:39 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection remove
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --rule-name --signature-id
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"snat\": {\r\n      \"privateRanges\": [\r\n        \"167.220.208.0/24\"\
        ,\r\n        \"167.221.205.102/32\"\r\n      ]\r\n    },\r\n    \"intrusionDetection\"\
        : {\r\n      \"mode\": \"Alert\",\r\n      \"configuration\": {\r\n      \
        \  \"signatureOverrides\": [\r\n          {\r\n            \"id\": \"20001\"\
        ,\r\n            \"mode\": \"Alert\"\r\n          }\r\n        ],\r\n    \
        \    \"bypassTrafficSettings\": [],\r\n        \"privateRanges\": [\r\n  \
        \        \"167.220.208.0/24\",\r\n          \"167.221.205.102/32\"\r\n   \
        \     ]\r\n      }\r\n    },\r\n    \"provisioningState\": \"Succeeded\"\r\
        \n  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"ba05e064-a6f0-484f-9d35-a50a692ce7e7\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1058'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:55:39 GMT
      etag:
      - '"ba05e064-a6f0-484f-9d35-a50a692ce7e7"'
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network firewall policy intrusion-detection list
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name
      User-Agent:
      - AZURECLI/2.50.0 (AAZ) azsdk-python-core/1.26.0 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy?api-version=2022-01-01
  response:
    body:
      string: "{\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"tier\": \"Premium\"\
        \r\n    },\r\n    \"childPolicies\": [],\r\n    \"ruleCollectionGroups\":\
        \ [],\r\n    \"firewalls\": [],\r\n    \"threatIntelMode\": \"Alert\",\r\n\
        \    \"snat\": {\r\n      \"privateRanges\": [\r\n        \"167.220.208.0/24\"\
        ,\r\n        \"167.221.205.102/32\"\r\n      ]\r\n    },\r\n    \"intrusionDetection\"\
        : {\r\n      \"mode\": \"Alert\",\r\n      \"configuration\": {\r\n      \
        \  \"signatureOverrides\": [\r\n          {\r\n            \"id\": \"20001\"\
        ,\r\n            \"mode\": \"Alert\"\r\n          }\r\n        ],\r\n    \
        \    \"bypassTrafficSettings\": [],\r\n        \"privateRanges\": [\r\n  \
        \        \"167.220.208.0/24\",\r\n          \"167.221.205.102/32\"\r\n   \
        \     ]\r\n      }\r\n    },\r\n    \"provisioningState\": \"Succeeded\"\r\
        \n  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_azure_firewall_policy_intrusion_detection000001/providers/Microsoft.Network/firewallPolicies/myFirewallPolicy\"\
        ,\r\n  \"name\": \"myFirewallPolicy\",\r\n  \"type\": \"Microsoft.Network/FirewallPolicies\"\
        ,\r\n  \"etag\": \"ba05e064-a6f0-484f-9d35-a50a692ce7e7\",\r\n  \"location\"\
        : \"westus\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1058'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 04 Aug 2023 08:55:41 GMT
      etag:
      - '"ba05e064-a6f0-484f-9d35-a50a692ce7e7"'
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
version: 1
